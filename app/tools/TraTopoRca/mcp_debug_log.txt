=== Starting Command ===
/root/miniconda3/envs/py310/bin/python -u -m tracegnn.models.gtrace.mymodel_test --report-dir reports_mcp --batch-size 32 --export-debug

WorkDir: /root/wzc/Trace_mcp/app/tools/TraTopoRca

2025-12-30 10:32:39.548 | INFO     | __main__:main:76 - Device: cpu
2025-12-30 10:32:39.548 | INFO     | __main__:main:77 - Dataset: dataset_demo (test=test)
2025-12-30 10:32:39.570 | INFO     | tracegnn.models.gtrace.dataset:init_config:37 - Get latency range...
  0%|          | 0/14000 [00:00<?, ?it/s]  4%|▍         | 591/14000 [00:00<00:02, 5899.68it/s]  8%|▊         | 1185/14000 [00:00<00:02, 5920.21it/s] 13%|█▎        | 1811/14000 [00:00<00:02, 6074.78it/s] 17%|█▋        | 2427/14000 [00:00<00:01, 6105.10it/s] 22%|██▏       | 3056/14000 [00:00<00:01, 6171.57it/s] 26%|██▌       | 3674/14000 [00:00<00:01, 6163.18it/s] 31%|███       | 4291/14000 [00:00<00:01, 6036.82it/s] 35%|███▌      | 4907/14000 [00:00<00:01, 6074.65it/s] 39%|███▉      | 5515/14000 [00:00<00:01, 5793.45it/s] 44%|████▎     | 6097/14000 [00:01<00:01, 5707.94it/s] 48%|████▊     | 6708/14000 [00:01<00:01, 5823.66it/s] 52%|█████▏    | 7293/14000 [00:01<00:01, 5796.97it/s] 56%|█████▋    | 7906/14000 [00:01<00:01, 5892.97it/s] 61%|██████    | 8513/14000 [00:01<00:00, 5945.45it/s] 65%|██████▌   | 9127/14000 [00:01<00:00, 6000.57it/s] 70%|██████▉   | 9740/14000 [00:01<00:00, 6037.01it/s] 74%|███████▍  | 10358/14000 [00:01<00:00, 6076.93it/s] 78%|███████▊  | 10977/14000 [00:01<00:00, 6108.13it/s] 83%|████████▎ | 11596/14000 [00:01<00:00, 6129.60it/s] 87%|████████▋ | 12222/14000 [00:02<00:00, 6167.91it/s] 92%|█████████▏| 12839/14000 [00:02<00:00, 6155.37it/s] 96%|█████████▌| 13455/14000 [00:02<00:00, 6149.59it/s]100%|██████████| 14000/14000 [00:02<00:00, 6026.75it/s]
2025-12-30 10:32:42.991 | INFO     | tracegnn.models.gtrace.dataset:__init__:316 - 4000 in test dataset.

==================================================
 [Model Architecture Summary] 
==================================================
 > Structure Branch : ISOC_VGAE (GNN Type: GIN)
 > Latency Branch   : TraceBERT (Transformer)
     |-- d_model    : 64 (Should be >= 64)
     |-- n_heads    : 4
     |-- layers     : 2
 > Host Branch      : OmniAnomaly (GRU-VAE)
==================================================

2025-12-30 10:32:43.336 | INFO     | __main__:main:103 - Loaded checkpoint from dataset/dataset_demo/save/tracebert/model.pth
2025-12-30 10:32:43.337 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:34 - Start Evaluation with nll...
2025-12-30 10:32:43.827 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:75 - Infra index: loaded for 11 hosts
  0%|          | 0/125 [00:00<?, ?it/s]  1%|          | 1/125 [00:02<04:10,  2.02s/it]  2%|▏         | 2/125 [00:04<04:09,  2.03s/it]  2%|▏         | 3/125 [00:05<03:58,  1.96s/it]  3%|▎         | 4/125 [00:07<03:47,  1.88s/it]  4%|▍         | 5/125 [00:09<03:47,  1.89s/it]  5%|▍         | 6/125 [00:11<03:45,  1.89s/it]  6%|▌         | 7/125 [00:13<03:42,  1.89s/it]  6%|▋         | 8/125 [00:15<03:43,  1.91s/it]  7%|▋         | 9/125 [00:17<03:40,  1.90s/it]  8%|▊         | 10/125 [00:19<03:36,  1.88s/it]  9%|▉         | 11/125 [00:20<03:29,  1.84s/it] 10%|▉         | 12/125 [00:22<03:31,  1.87s/it] 10%|█         | 13/125 [00:24<03:30,  1.88s/it] 11%|█         | 14/125 [00:26<03:27,  1.87s/it] 12%|█▏        | 15/125 [00:28<03:27,  1.88s/it] 13%|█▎        | 16/125 [00:30<03:25,  1.88s/it] 14%|█▎        | 17/125 [00:32<03:20,  1.85s/it] 14%|█▍        | 18/125 [00:33<03:17,  1.84s/it] 15%|█▌        | 19/125 [00:35<03:13,  1.82s/it] 16%|█▌        | 20/125 [00:37<03:11,  1.82s/it] 17%|█▋        | 21/125 [00:39<03:13,  1.86s/it] 18%|█▊        | 22/125 [00:41<03:13,  1.88s/it] 18%|█▊        | 23/125 [00:43<03:12,  1.89s/it] 19%|█▉        | 24/125 [00:45<03:09,  1.87s/it] 20%|██        | 25/125 [00:46<03:07,  1.88s/it] 21%|██        | 26/125 [00:48<03:08,  1.91s/it] 22%|██▏       | 27/125 [00:50<03:04,  1.88s/it] 22%|██▏       | 28/125 [00:52<03:01,  1.87s/it] 23%|██▎       | 29/125 [00:54<02:58,  1.86s/it] 24%|██▍       | 30/125 [00:56<02:57,  1.87s/it] 25%|██▍       | 31/125 [00:58<02:55,  1.87s/it] 26%|██▌       | 32/125 [01:00<02:52,  1.85s/it] 26%|██▋       | 33/125 [01:02<02:58,  1.94s/it] 27%|██▋       | 34/125 [01:04<02:53,  1.91s/it] 28%|██▊       | 35/125 [01:05<02:50,  1.89s/it] 29%|██▉       | 36/125 [01:07<02:48,  1.90s/it] 30%|██▉       | 37/125 [01:09<02:47,  1.90s/it] 30%|███       | 38/125 [01:11<02:44,  1.89s/it] 31%|███       | 39/125 [01:13<02:43,  1.90s/it] 32%|███▏      | 40/125 [01:15<02:45,  1.95s/it] 33%|███▎      | 41/125 [01:17<02:45,  1.97s/it] 34%|███▎      | 42/125 [01:19<02:41,  1.95s/it] 34%|███▍      | 43/125 [01:21<02:40,  1.96s/it] 35%|███▌      | 44/125 [01:23<02:37,  1.95s/it] 36%|███▌      | 45/125 [01:25<02:33,  1.91s/it] 37%|███▋      | 46/125 [01:27<02:31,  1.91s/it] 38%|███▊      | 47/125 [01:28<02:28,  1.90s/it] 38%|███▊      | 48/125 [01:30<02:27,  1.91s/it] 39%|███▉      | 49/125 [01:32<02:24,  1.90s/it] 40%|████      | 50/125 [01:34<02:21,  1.89s/it] 41%|████      | 51/125 [01:36<02:21,  1.91s/it] 42%|████▏     | 52/125 [01:38<02:21,  1.94s/it] 42%|████▏     | 53/125 [01:40<02:18,  1.93s/it] 43%|████▎     | 54/125 [01:42<02:14,  1.90s/it] 44%|████▍     | 55/125 [01:44<02:11,  1.88s/it] 45%|████▍     | 56/125 [01:46<02:10,  1.89s/it] 46%|████▌     | 57/125 [01:48<02:09,  1.90s/it] 46%|████▋     | 58/125 [01:49<02:07,  1.90s/it] 47%|████▋     | 59/125 [01:51<02:04,  1.88s/it] 48%|████▊     | 60/125 [01:53<02:03,  1.90s/it] 49%|████▉     | 61/125 [01:55<02:00,  1.89s/it] 50%|████▉     | 62/125 [01:57<01:58,  1.89s/it] 50%|█████     | 63/125 [01:59<01:56,  1.88s/it] 51%|█████     | 64/125 [02:01<01:53,  1.86s/it] 52%|█████▏    | 65/125 [02:03<01:52,  1.88s/it] 53%|█████▎    | 66/125 [02:04<01:50,  1.88s/it] 54%|█████▎    | 67/125 [02:06<01:48,  1.88s/it] 54%|█████▍    | 68/125 [02:08<01:48,  1.91s/it] 55%|█████▌    | 69/125 [02:10<01:46,  1.90s/it] 56%|█████▌    | 70/125 [02:12<01:42,  1.87s/it] 57%|█████▋    | 71/125 [02:14<01:42,  1.89s/it] 58%|█████▊    | 72/125 [02:16<01:41,  1.92s/it] 58%|█████▊    | 73/125 [02:18<01:39,  1.92s/it] 59%|█████▉    | 74/125 [02:20<01:43,  2.04s/it] 60%|██████    | 75/125 [02:22<01:38,  1.98s/it] 61%|██████    | 76/125 [02:24<01:35,  1.96s/it] 62%|██████▏   | 77/125 [02:26<01:31,  1.91s/it] 62%|██████▏   | 78/125 [02:28<01:30,  1.94s/it] 63%|██████▎   | 79/125 [02:30<01:28,  1.93s/it] 64%|██████▍   | 80/125 [02:31<01:26,  1.92s/it] 65%|██████▍   | 81/125 [02:33<01:22,  1.87s/it] 66%|██████▌   | 82/125 [02:35<01:20,  1.87s/it] 66%|██████▋   | 83/125 [02:37<01:19,  1.89s/it] 67%|██████▋   | 84/125 [02:39<01:18,  1.91s/it] 68%|██████▊   | 85/125 [02:41<01:16,  1.92s/it] 69%|██████▉   | 86/125 [02:43<01:13,  1.89s/it] 70%|██████▉   | 87/125 [02:45<01:10,  1.85s/it] 70%|███████   | 88/125 [02:46<01:09,  1.88s/it] 71%|███████   | 89/125 [02:48<01:05,  1.83s/it] 72%|███████▏  | 90/125 [02:50<01:04,  1.83s/it] 73%|███████▎  | 91/125 [02:52<01:02,  1.84s/it] 74%|███████▎  | 92/125 [02:54<01:00,  1.84s/it] 74%|███████▍  | 93/125 [02:56<00:59,  1.85s/it] 75%|███████▌  | 94/125 [02:57<00:56,  1.83s/it] 76%|███████▌  | 95/125 [02:59<00:55,  1.86s/it] 77%|███████▋  | 96/125 [03:01<00:54,  1.87s/it] 78%|███████▊  | 97/125 [03:03<00:52,  1.88s/it] 78%|███████▊  | 98/125 [03:05<00:51,  1.89s/it] 79%|███████▉  | 99/125 [03:07<00:49,  1.89s/it] 80%|████████  | 100/125 [03:09<00:47,  1.88s/it] 81%|████████  | 101/125 [03:11<00:44,  1.87s/it] 82%|████████▏ | 102/125 [03:13<00:43,  1.88s/it] 82%|████████▏ | 103/125 [03:14<00:41,  1.89s/it] 83%|████████▎ | 104/125 [03:16<00:39,  1.89s/it] 84%|████████▍ | 105/125 [03:18<00:37,  1.88s/it] 85%|████████▍ | 106/125 [03:20<00:35,  1.86s/it] 86%|████████▌ | 107/125 [03:22<00:33,  1.89s/it] 86%|████████▋ | 108/125 [03:24<00:31,  1.87s/it] 87%|████████▋ | 109/125 [03:26<00:29,  1.86s/it] 88%|████████▊ | 110/125 [03:28<00:28,  1.87s/it] 89%|████████▉ | 111/125 [03:29<00:25,  1.84s/it] 90%|████████▉ | 112/125 [03:31<00:24,  1.86s/it] 90%|█████████ | 113/125 [03:33<00:22,  1.84s/it] 91%|█████████ | 114/125 [03:35<00:19,  1.79s/it] 92%|█████████▏| 115/125 [03:36<00:16,  1.69s/it] 93%|█████████▎| 116/125 [03:38<00:15,  1.67s/it] 94%|█████████▎| 117/125 [03:39<00:13,  1.63s/it] 94%|█████████▍| 118/125 [03:41<00:11,  1.64s/it] 95%|█████████▌| 119/125 [03:42<00:09,  1.61s/it] 96%|█████████▌| 120/125 [03:44<00:08,  1.64s/it] 97%|█████████▋| 121/125 [03:46<00:06,  1.60s/it] 98%|█████████▊| 122/125 [03:48<00:05,  1.74s/it] 98%|█████████▊| 123/125 [03:50<00:03,  1.75s/it] 99%|█████████▉| 124/125 [03:51<00:01,  1.75s/it]100%|██████████| 125/125 [03:53<00:00,  1.78s/it]100%|██████████| 125/125 [03:53<00:00,  1.87s/it]
2025-12-30 10:36:37.472 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:274 - -------------------Graph Level Overall-----------------------
2025-12-30 10:36:37.486 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:280 - {'score_normal': -1.0979130268096924, 'auc': 1.0, 'best_threshold': 2.611895799636841, 'best_fscore': 1.0, 'best_pr': 1.0, 'best_rc': 1.0, 'threshold': -0.8138750014662743, 'median': -1.142134428024292, 'mad': 0.073802649974823, 'fscore': 0.8, 'precision': 0.6666666666666666, 'recall': 1.0}
2025-12-30 10:36:37.491 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:313 - -------------------Root Cause Analysis-----------------------
2025-12-30 10:36:37.526 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:484 - 服务级根因 Top1: 0.3450，Top5: 0.9900，AVG5: 0.4831
2025-12-30 10:36:45.657 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:515 - 主机级根因Top1: 0.5650，Top5: 0.9950，AVG5: 0.7238
2025-12-30 10:36:54.680 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:588 - 混合根因 Top1: 0.3325，Top5: 0.9050，AVG5: 0.6488 (svc_t1=0.0090, svc_t5=0.8108; host_t1=0.4567, host_t5=0.9412)
2025-12-30 10:36:54.681 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:739 - Detailed eval report saved to dataset/dataset_demo/processed/reports_mcp/eval_report_20251230_103654.md
2025-12-30 10:36:54.695 | INFO     | tracegnn.models.gtrace.mymodel_eval:evaluate:824 - RCA CSV exported to dataset/dataset_demo/processed/reports_mcp/rca_results_20251230_103654.csv
